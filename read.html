<!doctype html>
<html>
<head>
  <title>Write-up â€” Solasaki Comics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">

  <!-- Markdown parser -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <style>
    /* ------------------------------
       MEDIUM-STYLE READING LAYOUT
       ------------------------------ */
    .read-container {
      max-width: 760px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .read-title {
      font-family: "Patrick Hand";
      font-size: 36px;
      margin-bottom: 10px;
    }

    .read-meta {
      color: #6a6a6a;
      font-size: 15px;
      margin-bottom: 25px;
    }

    /* Medium style typography */
    #content h1, 
    #content h2, 
    #content h3 {
      font-family: "Patrick Hand";
      margin-top: 28px;
      margin-bottom: 12px;
    }

    #content p {
      line-height: 1.7;
      margin: 14px 0;
      font-size: 17px;
    }

    #content img {
      max-width: 100%;
      border-radius: 10px;
      margin: 18px 0;
    }

    /* Auto table of contents */
    .toc-box {
      border-left: 3px solid var(--accent);
      padding-left: 16px;
      margin-bottom: 30px;
    }

    .toc-box h3 {
      margin-bottom: 8px;
      font-family: "Patrick Hand";
    }

    .toc-box a {
      display: block;
      margin: 4px 0;
      text-decoration: none;
      color: var(--ink);
    }

    .toc-box a:hover {
      color: var(--accent);
    }
  </style>
</head>

<body class="fade">

<!-- â­ NORMAL HEADER (unchanged) -->
<header>
  <div class="logoarea">
    <img src="assets/uploads/IMG_0079.jpeg">
    <h1>Solasaki Comics</h1>
  </div>

  <nav>
    <a href="index.html">Home</a>
    <a href="comics.html">Comics</a>
    <a href="writeups.html">Write-ups</a>
    <a href="about.html">About</a>
    <a href="contact.html">Contact</a>
  </nav>

  <button class="toggle-mode" onclick="toggleMode()">ðŸŒ™</button>
</header>


<!-- â­ MEDIUM STYLE READING AREA -->
<div class="read-container">
  
  <h1 class="read-title" id="postTitle">Loadingâ€¦</h1>
  <div class="read-meta" id="postMeta"></div>

  <div class="toc-box" id="tocBox" style="display:none;">
    <h3>Contents</h3>
    <div id="toc"></div>
  </div>

  <div id="content"></div>
</div>


<footer>Â© 2025 Solasaki Comics</footer>


<script>
/* -----------------------------------------
   Extract ?post=filename from URL
----------------------------------------- */
const params = new URLSearchParams(window.location.search);
const file = params.get("post");

if (!file) {
  document.getElementById("postTitle").textContent = "Nothing found";
}



/* -----------------------------------------
   Fetch markdown from /writeups/
----------------------------------------- */
fetch(`/writeups/${file}.md`)
  .then(res => res.text())
  .then(md => {

    // Extract first heading as post title
    const firstLine = md.split("\n")[0].replace("#","").trim();
    document.getElementById("postTitle").textContent = firstLine;

    // Reading time
    const words = md.split(/\s+/).length;
    const minutes = Math.max(1, Math.round(words / 150));

    document.getElementById("postMeta").textContent =
      `${minutes} min read`;

    // Render markdown body
    const html = marked.parse(md);
    document.getElementById("content").innerHTML = html;

    // Auto generate TOC
    generateTOC();
  })
  .catch(() => {
    document.getElementById("postTitle").textContent = "Not found";
  });



/* -----------------------------------------
   Generate a Medium-style TOC
----------------------------------------- */
function generateTOC() {
  const content = document.getElementById("content");
  const headings = content.querySelectorAll("h2, h3");

  if (headings.length === 0) return;

  document.getElementById("tocBox").style.display = "block";

  const toc = document.getElementById("toc");
  toc.innerHTML = "";

  headings.forEach(h => {
    const id = h.textContent.replace(/\s+/g, "-").toLowerCase();
    h.id = id;

    const link = document.createElement("a");
    link.href = `#${id}`;
    link.textContent = h.textContent;

    toc.appendChild(link);
  });
}


/* -----------------------------------------
   Dark mode (same as other pages)
----------------------------------------- */
function toggleMode() {
  document.documentElement.classList.toggle("dark");
  localStorage.setItem(
    "mode",
    document.documentElement.classList.contains("dark") ? "dark" : "light"
  );
}

if (localStorage.getItem("mode") === "dark") {
  document.documentElement.classList.add("dark");
}
</script>

</body>
</html>
