<!doctype html>
<html lang="en">
<head>
  <title>Write-ups â€” Solasaki Comics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="style.css">
</head>

<body class="fade">

<header>
  <div class="logoarea">
    <img src="assets/uploads/IMG_0079.jpeg" alt="logo">
    <h1>Solasaki Comics</h1>
  </div>

  <nav>
    <a href="index.html">Home</a>
    <a href="comics.html">Comics</a>
    <a class="active" href="writeups.html">Write-ups</a>
    <a href="about.html">About</a>
    <a href="contact.html">Contact</a>
  </nav>

  <button class="toggle-mode" onclick="toggleMode()">ðŸŒ™</button>
</header>


<!-- PAGE CONTENT WRAPPER -->
<div class="page slide-up">

  <h2>Write-ups</h2>

  <p id="emptyMessage">This lazy person hasnâ€™t posted anything yetâ€¦ probably thinking about it.</p>

  <div id="writeupsContainer"></div>

</div>


<footer>Â© 2025 Solasaki Comics</footer>


<!-- â­ FIXED SCRIPT: Load Markdown (.md) + Text (.txt) Write-ups -->
<script>
async function loadWriteups() {
    const container = document.getElementById("writeupsContainer");
    const emptyMessage = document.getElementById("emptyMessage");

    try {
        // Request directory listing
        const response = await fetch("writings/");
        const text = await response.text();

        // Match any file ending in .md or .txt
        const files = [
            ...text.matchAll(/href="([^"]+\.(md|txt))"/g)
        ].map(m => m[1]);

        if (!files.length) {
            emptyMessage.style.display = "block";
            return;
        }

        emptyMessage.style.display = "none";

        for (const file of files.reverse()) {
            const res = await fetch(`writings/${file}`);
            const content = await res.text();

            // Format title from filename
            const title = file.replace(/\.(md|txt)/, "").replace(/-/g, " ");

            // Create entry block
            const entry = document.createElement("div");
            entry.className = "entry";
            entry.style.marginBottom = "30px";
            entry.style.padding = "15px";
            entry.style.border = "1px dashed var(--border)";
            entry.style.borderRadius = "10px";
            entry.style.background = "var(--bg2)";

            entry.innerHTML = `
                <h3 style="margin-bottom:8px">${title}</h3>
                <p style="margin-bottom:12px">${content.substring(0, 220)}...</p>
                <a href="writings/${file}" 
                   class="button"
                   style="padding:8px 16px; border-radius:8px; background:var(--accent); color:white; text-decoration:none;">
                    Read full
                </a>
            `;

            container.appendChild(entry);
        }

    } catch (err) {
        emptyMessage.textContent = "Error loading write-ups.";
        console.error(err);
    }
}

loadWriteups();
</script>


<!-- â­ Dark Mode -->
<script>
function toggleMode() {
    document.documentElement.classList.toggle("dark");
    localStorage.setItem(
        "mode",
        document.documentElement.classList.contains("dark") ? "dark" : "light"
    );
}

if (localStorage.getItem("mode") === "dark") {
    document.documentElement.classList.add("dark");
}
</script>

</body>
</html>
