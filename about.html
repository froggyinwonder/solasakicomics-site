<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About | Solasaki Comics</title>
    <link rel="stylesheet" href="style.css">

    <style>
        .draw-container {
            width: 100%;
            max-width: 900px;
            margin: 20px auto;
            background: #faf7ef;
            border: 2px dashed #d8cfc4;
            border-radius: 12px;
            padding: 10px;
        }

        #drawCanvas {
            width: 100%;
            height: 380px;
            background: #fdf9f3;
            border-radius: 8px;
            touch-action: none;
            transition: transform 0.1s ease-out, box-shadow 0.4s ease-out;
        }

        /* Wobble while drawing */
        #drawCanvas.wobble {
            transform: rotate(-1deg);
        }

        /* Glow when saved */
        #drawCanvas.glow {
            box-shadow: 0 0 18px #d2b2ff;
        }

        .tool-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .tool-buttons button {
            padding: 10px 18px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
        }

        .save-btn { background: #b48fd5; color: white; }
        .tool-btn { background: #eee; }
        .clear-btn { background: #ffc8c8; }

        /* Visitors' doodles */
        .doodles-grid {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 12px;
        }

        .doodles-grid img {
            width: 100%;
            border-radius: 8px;
            border: 2px solid #e5dacd;
        }
    </style>
</head>

<body>
<header>
    <a href="index.html"><h1>Solasaki Comics</h1></a>
    <nav>
        <a href="index.html">Home</a>
        <a href="comics.html">Comics</a>
        <a href="writeups.html">Write-ups</a>
        <a class="active" href="about.html">About</a>
        <a href="contact.html">Contact</a>
    </nav>
</header>

<main>
    <h2>About</h2>

    <p>Hello! Welcome to the yellow world. I'm Surbhi ‚Äî creator of Solasaki Comics.  
    I make simple comics inspired by my weird observations.  
    You can also read my writeups if you have nothing better to do.</p>

    <h3>Draw something for the artist or for yourself!!</h3>

    <div class="draw-container">
        <canvas id="drawCanvas"></canvas>

        <div class="tool-buttons">
            <button class="tool-btn" id="pencilBtn">‚úèÔ∏è Pencil</button>
            <button class="tool-btn" id="eraserBtn">üßΩ Eraser</button>
            <button class="tool-btn" id="undoBtn">‚Ü©Ô∏è Undo</button>
            <button class="clear-btn" id="clearBtn">üóëÔ∏è Clear</button>
            <button class="save-btn" id="saveBtn">Save Doodle</button>
        </div>
    </div>

    <h3>Visitors' doodles</h3>
    <div id="doodlesGrid" class="doodles-grid"></div>
</main>

<footer>
    <p>¬© 2025 Solasaki Comics</p>
</footer>


<!-- ‚≠ê FULL JS WITH SUPABASE + DRAW ENGINE ‚≠ê -->
<script type="module">
    /* ---- Supabase setup with YOUR real credentials ---- */
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

    const supabase = createClient(
        "https://rgxtvwnfqglsxnmvkkus.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJneHR2d25mcWdsc3hubXZra3VzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3NjEwNzksImV4cCI6MjA4MDMzNzA3OX0.twtdhIMF4xnaBQsird8CyEb3g3Kh8bI5REChohdyGwo"
    );

    /* ---------- Canvas Drawing Logic ---------- */
    const canvas = document.getElementById("drawCanvas");
    const ctx = canvas.getContext("2d");

    function resizeCanvas() {
        canvas.width = canvas.clientWidth;
        canvas.height = canvas.clientHeight;
    }
    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    let drawing = false;
    let erasing = false;
    let strokes = [];
    let currentStroke = [];

    const funnyMessages = [
      "That one's pretty!",
      "Could do better‚Ä¶ but I still like it.",
      "The artist appreciates this one.",
      "Ahhh‚Ä¶ try better next time.",
      "The world has never seen such talent (please never draw again).",
      "The moon criticises it quietly.",
      "Your doodle winked at me. Concerned.",
      "Beautiful! I will frame it in my imagination.",
      "Did your finger slip or is this intentional?",
      "My eyes‚Ä¶ they are confused but supportive.",
      "Modern art would sell this for ‚Çπ90,000.",
      "Picasso called. He wants tips from you.",
      "This belongs in a museum. A very small museum.",
      "Interesting‚Ä¶ very interesting‚Ä¶ worryingly interesting.",
      "I can‚Äôt tell what it is, but it feels emotional.",
      "Bold choice. Very bold.",
      "Masterpiece? Maybe. Chaos? Definitely.",
      "Your doodle is now canon in the Solasaki universe.",
      "Even the yellow balls are gossiping about this.",
      "Art police approves. Barely."
    ];

    function showFunnyMessage() {
        alert(funnyMessages[Math.floor(Math.random() * funnyMessages.length)]);
    }

    function getPos(e) {
        const rect = canvas.getBoundingClientRect();
        const pt = e.touches ? e.touches[0] : e;
        return { x: pt.clientX - rect.left, y: pt.clientY - rect.top };
    }

    function startDraw(e) {
        drawing = true;
        currentStroke = [];
        canvas.classList.add("wobble");
        const p = getPos(e);
        ctx.beginPath();
        ctx.moveTo(p.x, p.y);
        currentStroke.push({ ...p, erasing });
    }

    function draw(e) {
        if (!drawing) return;

        const p = getPos(e);
        ctx.lineWidth = erasing ? 20 : 3;
        ctx.lineCap = "round";
        ctx.strokeStyle = erasing ? "#fdf9f3" : "#333";

        ctx.lineTo(p.x, p.y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(p.x, p.y);

        currentStroke.push({ ...p, erasing });
    }

    function endDraw() {
        drawing = false;
        canvas.classList.remove("wobble");
        if (currentStroke.length > 0) strokes.push(currentStroke);
        ctx.beginPath();
    }

    /* Event Listeners */
    canvas.addEventListener("mousedown", startDraw);
    canvas.addEventListener("mousemove", draw);
    canvas.addEventListener("mouseup", endDraw);
    canvas.addEventListener("mouseleave", endDraw);

    canvas.addEventListener("touchstart", startDraw);
    canvas.addEventListener("touchmove", draw);
    canvas.addEventListener("touchend", endDraw);
    canvas.addEventListener("touchcancel", endDraw);

    /* Tools */
    pencilBtn.onclick = () => erasing = false;
    eraserBtn.onclick = () => erasing = true;

    undoBtn.onclick = () => {
        strokes.pop();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        redraw();
    };

    clearBtn.onclick = () => {
        strokes = [];
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    };

    function redraw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let stroke of strokes) {
            for (let i = 0; i < stroke.length; i++) {
                const p = stroke[i];
                ctx.lineWidth = p.erasing ? 20 : 3;
                ctx.strokeStyle = p.erasing ? "#fdf9f3" : "#333";
                if (i === 0) ctx.moveTo(p.x, p.y);
                else ctx.lineTo(p.x, p.y);
                ctx.stroke();
            }
            ctx.beginPath();
        }
    }

    /* Save Doodle */
    saveBtn.onclick = async () => {
        canvas.classList.add("glow");
        setTimeout(() => canvas.classList.remove("glow"), 600);

        canvas.toBlob(async (blob) => {
            const filename = `doodle-${Date.now()}.png`;

            const { error } = await supabase.storage
                .from("doodles")
                .upload(filename, blob);

            if (!error) {
                showFunnyMessage();
                loadDoodles();
                cleanupOldDoodles();
            }
        });
    };

    /* Auto delete old doodles if > 50MB */
    async function cleanupOldDoodles() {
        const { data } = await supabase.storage.from("doodles").list();

        let total = 0;
        data.forEach(f => total += f.metadata.size);

        if (total > 50 * 1024 * 1024) {
            const oldest = data.sort((a,b)=>a.created_at>b.created_at?1:-1)[0];
            await supabase.storage.from("doodles").remove([oldest.name]);
        }
    }

    /* Load visitor doodles */
    async function loadDoodles() {
        const { data } = await supabase.storage.from("doodles").list();
        const grid = document.getElementById("doodlesGrid");

        grid.innerHTML = "";

        data.reverse().forEach(file => {
            const url =
                `https://rgxtvwnfqglsxnmvkkus.supabase.co/storage/v1/object/public/doodles/${file.name}`;

            const img = document.createElement("img");
            img.src = url;
            grid.appendChild(img);
        });
    }

    loadDoodles();
</script>

</body>
</html>
