<!doctype html>
<html>
<head>
  <title>About — Solasaki Comics</title>
  <link rel="stylesheet" href="style.css">
</head>

<body class="fade">

<header>
  <div class="logoarea">
    <img src="assets/uploads/IMG_0079.jpeg">
    <h1>Solasaki Comics</h1>
  </div>

  <nav>
    <a href="index.html">Home</a>
    <a href="comics.html">Comics</a>
    <a href="writeups.html">Write-ups</a>
    <a href="about.html" class="active">About</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<div class="page slide-up">
  <h2>About Me</h2>

  <p>
    Hello! Welcome to the yellow world. I'm Surbhi — creator of Solasaki Comics.<br>
    I make simple comics inspired by my weird observations.<br>
    You can also read my writeups if you have nothing better to do.
  </p>

  <hr>

  <h3>Draw Something!</h3>
  <p>Draw something for the artist or yourself. Something fun ✨</p>

  <canvas id="drawpad" width="350" height="350"></canvas>

  <button id="save-btn">Save Doodle</button>

  <h3>Community Doodles</h3>
  <div id="doodle-wall"></div>
</div>

<footer>© 2025 Solasaki Comics</footer>

<!-- SUPABASE + DRAW SCRIPT -->
<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  /* ----------- YOUR SUPABASE PROJECT DETAILS ----------- */
  const SUPABASE_URL = "https://rgxtvwnfqglsxnmvkkus.supabase.co";

  const SUPABASE_ANON_KEY =
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJneHR2d25mcWdsc3hubXZra3VzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3NjEwNzksImV4cCI6MjA4MDMzNzA3OX0.twtdhIMF4xnaBQsird8CyEb3g3Kh8bI5REChohdyGwo";

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  /* ----------- DRAWING SETUP ----------- */
  const canvas = document.getElementById("drawpad");
  const ctx = canvas.getContext("2d");
  let drawing = false;

  // mouse drawing
  canvas.addEventListener("mousedown", start);
  canvas.addEventListener("mouseup", end);
  canvas.addEventListener("mousemove", draw);

  // touch drawing (mobile)
  canvas.addEventListener("touchstart", e => start(touchToMouse(e)));
  canvas.addEventListener("touchend", end);
  canvas.addEventListener("touchmove", e => draw(touchToMouse(e)));

  function touchToMouse(e) {
    const touch = e.touches[0];
    return {
      clientX: touch.clientX,
      clientY: touch.clientY
    };
  }

  function start(e) { drawing = true; draw(e); }
  function end() { drawing = false; ctx.beginPath(); }

  function draw(e) {
    if (!drawing) return;
    const rect = canvas.getBoundingClientRect();
    ctx.lineWidth = 3;
    ctx.lineCap = "round";
    ctx.strokeStyle = "#333";

    ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
  }

  /* ----------- SAVE DOODLE ----------- */
  document.getElementById("save-btn").addEventListener("click", async () => {
    const dataUrl = canvas.toDataURL("image/png");
    const blob = await (await fetch(dataUrl)).blob();
    const filename = `doodle-${Date.now()}.png`;

    let { error } = await supabase.storage
      .from("doodles")
      .upload(filename, blob, { contentType: "image/png" });

    if (error) {
      alert("Error saving doodle!");
      return;
    }

    alert("Doodle saved! ✨");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    loadDoodles();
  });

  /* ----------- LOAD DOODLES FROM SUPABASE ----------- */
  async function loadDoodles() {
    const wall = document.getElementById("doodle-wall");
    wall.innerHTML = "";

    let { data } = await supabase.storage.from("doodles").list("");

    data.forEach(file => {
      const url =
        `${SUPABASE_URL}/storage/v1/object/public/doodles/${file.name}`;
      const img = document.createElement("img");
      img.src = url;
      img.className = "tiny-doodle";
      wall.appendChild(img);
    });
  }

  loadDoodles();
</script>

<!-- Doodle Wall Styles -->
<style>
  #drawpad {
    background: #fff;
    border: 2px dashed #aaa;
    border-radius: 8px;
    touch-action: none;
    width: 100%;
    max-width: 350px;
  }

  #save-btn {
    margin-top: 10px;
    padding: 10px 20px;
    background: #b88fbf;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
  }

  #doodle-wall {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 15px;
  }

  .tiny-doodle {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 8px;
    opacity: 0.85;
    transition: 0.3s;
  }

  .tiny-doodle:hover {
    transform: scale(1.2);
    opacity: 1;
  }
</style>

</body>
</html>
